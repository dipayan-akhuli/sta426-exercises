"0","ei <- ei(sce)"
"0",""
"0","# linear mixed model with a random intercept for each patient"
"0","ds_formula1 <- createFormula(ei, cols_fixed=""condition"", cols_random=""patient_id"")"
"0",""
"0","# regular linear model"
"0","ds_formula2 <- createFormula(ei, cols_fixed=""condition"") "
"0",""
"0","# create contrasts between conditions"
"0","contrast <- createContrast(c(0,1))"
"0",""
"0","# run diffcyt for the two models at the 8-metacluster level"
"0","res_ds1 <- diffcyt(sce, ei, formula=ds_formula1, contrast=contrast, analysis_type=""DS"", method_DS=""diffcyt-DS-LMM"", clustering_to_use=""meta8"")"
"0",""
"0","res_ds2 <- diffcyt(sce, ei, formula=ds_formula2, contrast=contrast, analysis_type=""DS"", method_DS=""diffcyt-DS-LMM"", clustering_to_use=""meta8"")"
"0",""
"0","# test results for the two models"
"0","(tbl_ds1 <- rowData(res_ds1$res))"
"1","DataFrame"
"1",""
"1"," with "
"1",""
"1","112"
"1",""
"1"," row"
"1",""
"1","s"
"1",""
"1"," and "
"1",""
"1","4"
"1",""
"1"," column"
"1",""
"1","s"
"1",""
"1","
"
"1","   "
"1"," cluster_id"
"1"," marker_id"
"1","       p_val"
"1","       p_adj"
"1","
   "
"1","   <factor>"
"1","  <factor>"
"1","   <numeric>"
"1","   <numeric>"
"1","
1  "
"1","          1"
"1","     pNFkB"
"1"," 2.44332e-07"
"1"," 8.55162e-07"
"1","
2  "
"1","          2"
"1","     pNFkB"
"1"," 3.10957e-08"
"1"," 1.28990e-07"
"1","
3  "
"1","          3"
"1","     pNFkB"
"1"," 2.68674e-14"
"1"," 2.31473e-13"
"1","
4  "
"1","          4"
"1","     pNFkB"
"1"," 4.77849e-11"
"1"," 2.81679e-10"
"1","
5  "
"1","          5"
"1","     pNFkB"
"1"," 3.28304e-09"
"1"," 1.53209e-08"
"1","
..."
"1","        ..."
"1","       ..."
"1","         ..."
"1","         ..."
"1","
4  "
"1","          4"
"1","       pS6"
"1"," 3.16311e-05"
"1"," 9.08379e-05"
"1","
5  "
"1","          5"
"1","       pS6"
"1"," 1.58638e-03"
"1"," 3.52018e-03"
"1","
6  "
"1","          6"
"1","       pS6"
"1"," 2.87609e-07"
"1"," 9.76128e-07"
"1","
7  "
"1","          7"
"1","       pS6"
"1"," 0.00000e+00"
"1"," 0.00000e+00"
"1","
8  "
"1","          8"
"1","       pS6"
"1"," 1.14738e-03"
"1"," 2.79361e-03"
"1","
"
"0","(tbl_ds2 <- rowData(res_ds2$res))"
"1","DataFrame"
"1",""
"1"," with "
"1",""
"1","112"
"1",""
"1"," row"
"1",""
"1","s"
"1",""
"1"," and "
"1",""
"1","4"
"1",""
"1"," column"
"1",""
"1","s"
"1",""
"1","
"
"1","   "
"1"," cluster_id"
"1"," marker_id"
"1","       p_val"
"1","       p_adj"
"1","
   "
"1","   <factor>"
"1","  <factor>"
"1","   <numeric>"
"1","   <numeric>"
"1","
1  "
"1","          1"
"1","     pNFkB"
"1"," 1.44285e-04"
"1"," 0.000850520"
"1","
2  "
"1","          2"
"1","     pNFkB"
"1"," 9.50763e-04"
"1"," 0.003600878"
"1","
3  "
"1","          3"
"1","     pNFkB"
"1"," 2.05407e-04"
"1"," 0.001023640"
"1","
4  "
"1","          4"
"1","     pNFkB"
"1"," 1.23368e-05"
"1"," 0.000151000"
"1","
5  "
"1","          5"
"1","     pNFkB"
"1"," 3.75724e-05"
"1"," 0.000350676"
"1","
..."
"1","        ..."
"1","       ..."
"1","         ..."
"1","         ..."
"1","
4  "
"1","          4"
"1","       pS6"
"1"," 1.20918e-03"
"1"," 4.23214e-03"
"1","
5  "
"1","          5"
"1","       pS6"
"1"," 1.07569e-02"
"1"," 3.34660e-02"
"1","
6  "
"1","          6"
"1","       pS6"
"1"," 5.75568e-04"
"1"," 2.47937e-03"
"1","
7  "
"1","          7"
"1","       pS6"
"1"," 3.68328e-12"
"1"," 4.12527e-10"
"1","
8  "
"1","          8"
"1","       pS6"
"1"," 1.00081e-02"
"1"," 3.20259e-02"
"1","
"
"0","threshold <- 0.05"
"0",""
"0","# number of DS findings for the two models at FDR <= 0.05"
"0","table(tbl_ds1$p_adj<=threshold)"
"1","
"
"1","FALSE "
"1"," TRUE "
"1","
"
"1","   28 "
"1","   84 "
"1","
"
"0","table(tbl_ds2$p_adj<=threshold)"
"1","
"
"1","FALSE "
"1"," TRUE "
"1","
"
"1","   70 "
"1","   42 "
"1","
"
